---
layout: post
title: TheLinuxCommandLine
date: 2019-08-05 16:13:13
categories: [Linux]
tags: [CommandLine]
---

# TheLinuxCommandLine

1. 夺回计算机管理权
   + 只有知道计算机正在做什么你才能够拥有这种“自由”

## 什么是shell

1. shell 和 Termial关系

   + shell : 是一个程序, 接受从键盘输入的指令, 然后将其传递到OS执行;

   + Termial : 可以输入命令行;

2. 交互关系

   + 人和Tremial 进行交互

   + Termial  用于和shell 交互;

   + shell 用于和操作系统交互

3. 什么是命令

   + 是一个可执行程序;
   + 是 一 个 内 建 于 shell 自 身 的 命 令。
   + 是一个 shell 函数。
   + 是一个命令别名。我们可以定义自己的命令,建立在其它命令之上。

### shell 命令

|   显示作用   | shell命令            | 作用                                              |
| :----------: | -------------------- | ------------------------------------------------- |
|     日期     | date                 | 令显示系统当前时间和日期, 输出一行                |
|              | cal                  | 输出整个月的日期                                  |
|   空间磁盘   | df                   | 查看磁盘所有的dev剩余空间的数量                   |
|              | free                 | 只显示剩余空间和使用空间                          |
|     终止     | exit                 | 终止终端会话                                      |
|   目录显示   | pwd                  | 显示当前工作目录 print current working directory  |
|              | cd                   | 更改目录; 相对和绝对路径                          |
|              | cd -                 | 返回工作目录到先前目录                            |
|              | ls  / ls -a          | 列出目录下的文件名 /  包含两个目录文件            |
|              | **ls -l  /  ls -al** | 当前目录下文件的详细信息 / 包含**两个目录文件**   |
|              | stat > ls (作用比较) | 显示文件的修改时间信息, 	包括文件的元数据;     |
|   文本类型   | file name            | 输出文件所属的类型                                |
|              | **less**  name       | less 命令是一个用来**浏览文本文件**的程序。       |
|              | 双击 + 鼠标中键      | 命令行文件名的复制和粘贴                          |
| **操作文件** | cp                   | 复制文件和目录                                    |
|   (通配符)   | mv                   | 移动/重命名文件和目录                             |
|              | mkdir                | 创建目录                                          |
|              | rm                   | —删除文件和目录;  **小心使用命令**                |
|              | ln / ln -s           | —创建硬链接和符号链接                             |
| **命令操作** | type command         | 显示命令的类别,给出一个特定的命令名               |
|              | which                | 显示一个命令的位置                                |
|              | help                 | 得到 shell 内部命令的帮助文档                     |
|              | man                  | 一个特殊的叫做 man 的分页程序,可用来浏览他们      |
|              | whatis               | 显示非常简洁的命令说明                            |
|              | info                 | 显示程序 Info 条目                                |
|  **重定向**  | cat                  | cat 命令读取一个或多个文件,然后复制它们到标准输出 |
|              | less                 | 将内容显示在标准输出                              |
|              | **sort**             | 排序文本内容;                                     |
|              | \|                   | 通过管道线: **将多个命令结合使用**                |
|              | wc                   | 打印行,字和字节数                                 |
|              | grep                 | 打印匹配行; 用作正则表达式                        |
|              | head / tail -n       | 打印文件开头部分/结尾部分                         |
|              | unip                 | 忽略重复行   sort foo.txt \| uuip                 |
|   文本操作   | echo                 | 显示一行文本                                      |
|              | echo + 通配符        | 实现路径名展开                                    |
|              | { }; " "; ''         | 引用和展开是相反的                                |
|   键盘操作   | clear                | -清空屏幕                                         |
|              | history              | 显示历史列表内容                                  |
|              | 其他的光标移动命令   |                                                   |
|     权限     | chmod                | 更改文件模式                                      |
|              | chown                | 更改文件所有者                                    |
|              | su/sudo              | 有区别的                                          |
|     进程     | ps / ps x            | 查看进程信息 / 查看所有进行信息 pid               |
|              | top                  | 动态查看进程状态                                  |
|              | bg / &               | 让进程处于后台                                    |
|              | fg %1                | 让进程返回前台;跟随着一个百分号和工作序号         |
|              | kill all             | 杀死进程                                          |
|     线程     | cat /proc/pid/status | // 查询对应pid 的线程数量                         |
|   环境变量   | printenv             | –打印部分或所有的环境变量                         |
|              | set                  | 设置环境变量                                      |
|              | export               | 导出环境变量,让随后执行的程序知道                 |
|              | source               | 激活设置                                          |
|  文本编辑器  | nano                 | 第一个基于文本的文本编辑器,nano。                 |
|              | gedit                | 图形化编辑器                                      |
|              | vi                   | 命令行编辑                                        |
|   存储媒介   | mount / umount       | 挂载 / 卸载 一个文件系统                          |
|              | mksf                 | 创建文件系统                                      |
|              | dd                   | —把面向块的数据直接写入设备                       |
|   网络系统   | ping                 | - 发送 ICMP ECHO REQUEST 软件包到网络主机         |
|              | traceroute           | 打印到一台网络主机的路由数据包                    |
|              | wget                 | 非交互式网络下载器                                |
|              | netstat              | 程序被用来检查各种各样的网络设置和统计数据。      |
|              | ssh                  | SSH 解决了这两个基本的和远端主机安全交流的问题    |
|   查找文件   | locate               | –通过名字来查找文件  locate zip \| grep bin       |
|              | find                 | 程序能基于各种各样的属性, 查找文件                |
|  归档和备份  | gzip / bzip2         | 是文件压缩程序:                                   |
|              | tar / zip            | 归档程序:                                         |
|  格式化输出  | fmt                  | 一个简单的文本格式转换器                          |
|              | printf               | –一个文件格式系统                                 |
|   编译程序   | make                 | 只是构建需要的部分,不是重新构建所有的内容。       |

### 绝对路径 / 相对路径 

1. 绝对路径 : 从根目录开始, 直到它的目的地
2. 相对路径 : 相对与当前目录
   + 一对特殊符号表示相对位置
     + " . " : 指的是工作目录
     + " .. ": 工作目录的父目录;

### ls -l 长格式输出

{% asset_img ls_l.png %}

1. **第一个字段 d/-rw-r--r--**  的含义

   + 第一个字母 : **文件类型**
     + 是 " d " : 表示目录
     + 是 " - " : 表示普通文件
   + 后面三个字段: **文件权限**
     + 文件所有者权限
     + 文件所属组成员权限
     + 其他所有人访问权限
   + read / write / exec(执行)

2. 后面的字段

   {% asset_img ls_l_file.png %}

### 文本的定义

1. less : 浏览文本文件的程序

   +  less 就是 more(禅语:色即是空)
   + 文本 : 是简单的字符与数字之间的一对一映射。

2. less 常用的键盘命令

   {% asset_img less_command.png %}

## 操作文件的5个命令

### 通配符: 快速匹配文件名

1. shell 提供了特殊字符来帮助你快速指定一组文件名

   {% asset_img 通配符.png %}

### CP 复制命令

1. cp复制的两种方式

   ```
   $ cp file1 file2	// 复制单个文件或目录 “item1” 到文件或目录”item2”
   $  cp 	file...	directory	//	赋值多个项目到同一个目录
   ```

2. cp 的附加属性

   + 赋值目录中的文件到另外的目录下时: 目的目录需要存在

   {% asset_img cp_file.png %}

### mv移动

1. mv的属性和cp基本类似, 只是mv移动后, 源目录下的文件会被删除;

### 硬链接和软链接

1. 硬链接的缺陷

   + 一个硬链接 : **不能**关联它所在**文件系统**之外的文件
   + 一个硬链接不能关联一个目录。

2. 硬链接的特性

   + 你要记得一个文件至少有一个硬链接, 因为文件名就是由链接创建的

3. 符号链接特性

   + 如果你往一个符号链接里面写入东西, 那么相关联的文件也被写入;
   + 符号链接删除:  链接仍然存在,但是不指向任何东西, ls 呈现红色

   ```
   $  ln -s ../fun dir2/fun-sym	// 不同文件下的目录链接
   ```

## 重定向操作(I/O)

### 重定向

1. 标准输入,输出,和错误:  **默认情况下**

   + 标准输出(fd=1)和标准错误(fd=2) : 都**连接到屏幕**
   + 标准输入(fd =0) : 连接到键盘

2. 重定向**标准输出**

   + I/O 重定向允许我们来重定义标准输出送到哪里。

   ```
   $ echo hello > file		//   ">" 将字符hello重定向到文件FILE
   ```

3. 把重定向结果追加

   + 重定向文件: 从开头重写文件;

   ```
   $ echo word >> file		//" >> " 使用这个进行追加
   ```

4. 重定向标准错误

   + 文件描述符 “2”,紧挨着放在重定向操作符之前
   + 当文件不存在的时候就报错

   ```
   $ ls -l file 2> log.txt		// 将文件FILE的信息输出到文件.txt中
   ```

5. 重定向标准输出和标准错误 到同一文件

   ```
   $ echo hello > file 2>&1		// 通过 " 2>&1	 "
   $ echo hello &> dile				// 通过 " &> "
   ```

### cat 命令

1. 只输入cat

   ```
   $ cat		// 等待键盘标准输入, 将用户输入的结果, 通过屏幕显示;
   $ cat 	>	file.txt		// 等待键盘标准输入, 将用户输入的结果, 重定向到文件
   ```

2. 们把标准输入源从键盘改到文件输入

   ```
   $ cat < file.txt		// 将文件内容作为标准输入, 然后将其内容屏幕显示;
   ```

### 管道线

1. 管道线: 命令可以从标准输入读取数据,然后再把数据输送到标准输出

   ```
   $ ls -l file | less		// 将文件内容进行标注输出
   ```

2. 通过管道线将多个命令综合输出

   ```
   $ ls 	 /usr/bin 	| sort 	| uniq 	| grep zip	// 匹配zip出现的位置
   $ ls 	/usr/bin | sort | uniq | wc -l		// 显示次数
   ```

### 文本操作

1. echo 操作 + 通配符?

   + 实现路径名展开

   ```
   $ echo *		// 通配符展开
   $ echo ~ 		// 显示当前用户目录
   $ echo $USER	// 用户展开
   ```

2. 进行算数操作

   ```
   $ echo $((2 + 2))		// 算术表达式展开使用这种格式:$((expression))
   ```

3. 花括号展开

   + 花括号展开模式可能包含一个开头部分叫做报头,一个结尾部分叫做附言。

   ```
   $  echo {Z..A}
   ```

   + 用于创建一系列的目录, 或者文件

   ```
   $ mkdir {2007..2009}-0{1..9} {2007..2009}-{10..12}
   ```

4. 双引号

   + 意味着单词分割,路径名展开,波浪线展开,和花括号展开都被禁止

   ```
   $  ls -l "two words.txt"		// 直接显示文件名的详细信息
   ```

   + ,除了 $,\ (反斜杠),和 ‘(倒引号)之外, 其他字符则失去它们的特殊含义,

   ```
    echo "$USER $((2+2)) $(cal)"
   ```

5. 单引号 

   + 禁止所有的展开

   ```
    $ echo text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER
   // 直接输出文本内容, 不进行展开
   ```

6. grep 正则表达式

   + 一个连行符 : 由一个斜杠字符其后紧跟一个回车符组成。它们之间不允许有空白字符。

## 快捷键

###  键盘操作 

1. 移动光标

   {% asset_img  移动光标.png %}

2. 修改文本

   {% asset_img 修改文本.png %}

### vi编辑

{% asset_img vi_command.png %}

| 位置       | VI的基本命令           | 功能                                        |
| ---------- | ---------------------- | ------------------------------------------- |
| 先按Esc    |                        | 退出插入模式之后才能使用                    |
| 行编辑     | k - j - h - l          | 上 - 下 - 左 - 右                           |
|            | number + j             | 向下移动多少行                              |
|            | 0(零按键)              | 移动到当前行行首                            |
|            | $                      | 移动至当前行行尾                            |
|            | o                      | 在当前行下方打开一行                        |
|            | O                      | 在当前行上方打开一行                        |
| 文本编辑   | gg                     | 移动至文本的第一行                          |
|            | G                      | 移动至文本的**最后**一行                    |
|            | numberG                | 移动至某一行                                |
| 页编辑     | Ctrl + f               | 向下翻一页                                  |
|            | Ctrl + b               | 向上翻一页                                  |
| 撤销       | u                      | 撤销最后一次的编辑                          |
| 删除文本   | x / number + x(一起按) | 删除当前字符 / number个字符                 |
|            | dd                     | 删除当前行                                  |
|            | dG / d+ numbger + G    | 删除当前行到文本末尾 / 删除当前行到文本末尾 |
| 复制和粘贴 | yy / p                 | 复制和粘                                    |
| 链接行     | J                      | 上下行连接                                  |
| 查找       | /line                  | 查找                                        |



文本操作

+ d: 剪切文本
+ p:  复制文本到光标位置

1. 查找替换
   + /  : 用于文本查找

## 权限操作

### chmod 文件权限

1. 用 3 个八进制数字,我们能够设置文件所有者,用户组,和其他人的权限:

   {% asset_img chmod.png %}

   + :7 (rwx),6 (rw-),5 (r-x),4 (r--),and 0 (-–)
   + “600”,我们能够设置文件所有者的权限为读写权限, 而删除用户组和其他人的所有权限。

2. 用户标识

   {% asset_img chmod_user.png %}

### su/sudo

1. su 和 sudo 之间的一个重要区别
   +  sudo 不会重新启动一个 shell,也不会加载另一个用户的 shell 运行环境。

## 软件包管理

+ Debian 的 “.deb”,和红帽的”.rpm”

  {% asset_img debian.png %}

1. 软件包管理工具

   {% asset_img dpkg.png %}

## 编写一个shell脚本

### 基本脚本的编写

1. 脚本的格式

   ```
   #!/bin/bash
   # This is our first script.
   echo 'Hello World!'
   ```

2. 设置权限, 让脚本可与运行

   + 注意为了能够执行脚本,脚本必须是可读的。

   ```
   $ chmod 777 file
   ```

3. 脚本文件的执行

   ```
   $ ./file		 // 基本的执行方式
   $ file			// 如果将脚本放在 /bin 目录下, 那么不需要指定脚本的路径, 就可以直接执行;
   ```

### 自顶向下设计

1. 自顶向下设计是一种常见的程序设计方法,尤其适合 shell 编程。
2. shell 可以使用数据结构: 字符串, 数组
3. shell 可以使用一些控制流程: if while