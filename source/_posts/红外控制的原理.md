---
layout: post
title: 红外控制的原理
date: 2019-09-09 07:45:07
categories: [driver]
tags:	[红外控制]
---

# 红外控制原理以及PLC编程

1. [参考链接](https://blog.csdn.net/techelefeng/article/details/45972583)

##  原理描述

1. 红外的信息传递？

   + 利用一个红外发光二极管，以红外光为载体，将**按键信息**传递给接收端的设备
   + 红外光对于人眼是不可见的，因此使用红外遥控器不会影响人的视觉

2. 信息的调制

   + 调制：提取红外光中有效的信息；
   + 作用：通过调制我们可以使红外光以特定的**频率闪烁**，红外接收器会适配这个频率，其它的噪音信号都将被忽略。
   + 闪烁是引起接收器“注意”的方法

3. 左侧，调制信号通过驱动放大由红外 LED **发射**；右侧，信号通过接收器检测输出

   {% asset_img ways.png %}

   + 红外光的频段：红外遥控器38KHz，脉冲频率普遍采用 30KHz 到 60KHz 这个频段
   + 串行通讯里，我们经常谈及‘ mark’和‘ space’标记

   1. 在发送端
      +  space：是个默认信号，是指发射管关闭状态，在‘ space’期间，红外光不被发射；
      +  mark：状态期间，红外光以特定的频率脉冲形式发射
   2. 在接收端
      +  space：信号以高电平方式重现输出
      +  mark：信号便是以低电平方式重现

## NEC协议 -- 红外控制的协议

1. NEC协议的要求
   + 8 位地址码， 8 位命令码
   + 提高可靠性：完整**发射两次**地址码和命令码
   + 调制方式：脉冲**时间长短**
   + 38KHz 载波频率
   + **位时间**： 1.12ms -- 0 或 2.25ms -- 1

### 完整的NEC协议的典型脉冲链

{% asset_img NEC_signal.png %}

1. 引导码的调制波形：由“9ms mark + 4.5ms space”构成，表示一组 键码 的开始。

   {% asset_img guide.png %}

2. 逻辑1和逻辑0的调制波形

   + 逻辑1：由560us mark + 1690 space组成，symbol period 为2.25ms；
   + 逻辑0：由560us mark + 560us space组成，symbol period 为 1.12ms；

   {% asset_img logical.png %}

### 重复码

1. 重复码表示一个重复按键

   + 当按键按着不松时，**会先发一个完整的键码**；
   + 接着每 110ms 发送一个重复码，直到松开按键

   {% asset_img Duplicate_code.png %}

2. 重复码的表示

   + 重复码由 “9ms mark + 2.25ms space”组成，symbol period 为 11.25ms

   {% asset_img Duplicate.png %}

3. 接收端：如何接受重复码

   + 对于引导码：接收端和发送端相反

   {% asset_img Duplicate_receive.png %}

5. 

## LUA 脚本语言

1. Lua脚本语言
   + 是一个扩展式程序设计语言，它被设计成支持通用的过程式编程，并有相关数据描述的设施
   + Lua 也能对面向对象编程，函数式编程，数据驱动式编程提供很好的支持。
2. Lua语言的特点
   + 作为一个扩展式语言，Lua 没有 "main" 程序的概念
   + 它只能 *嵌入* 一个宿主程序中工作，这个宿主程序被称作*embedding program* 或简称为 *host* 
   +  Lua 的官方发布版就包含了一个叫做 `lua` 的简单的宿主程序，它用 Lua 库提供了一个保证独立的 Lua 解释器。