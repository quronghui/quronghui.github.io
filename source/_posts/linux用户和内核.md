---
layout: post
title: linux用户和内核
date: 2019-08-02 21:18:12
categories: [Operate System]
tags: linux
---

#  linux用户和内核

## linux用户和内核之间的关系

1. Linux的**用户态与内核态 **定义?
   - Intel的X86架构的CPU提供了**0到3四个特权级**: Linux操作系统中则主要采用了**0(内核)**和**3(用户)**两个特权级
   - 进程寻址空间0~4G , 用户态只能访问0~3G，只有进入**内核态**才能访问3G~4G  
2. Linux的**用户态与内核态 **如何切换的?
   - **系统调用**:
     - 用户态的进程通过系统调用申请使用操作系统提供的**系统调用服务例程**来处理任务
     - **机制:** 操作系统为用户特别开发的一个中断机制来实现的，即软中断
   - **内存产生异常时**
     - 如缺页异常
   - **外设产生中断**
     - 比如硬盘读写操作的完成，系统会切换到硬盘读写的中断处理程序中执行后续操作等。   
3. Linux的用户态与内核态的**通信**方式?
   - Linux下内核空间与用户空间进行通信的方式主要有syscall（system call）、procfs、ioctl和netlink
   - syscall（system call）
     - Linux内核中设置了一组用于**实现各种系统功能**的子程序
     - 用户可以通过调用**系统调用接口（SCI）**, 访问linux内核的数据和函数
   - procfs
     - 是一种特殊的伪文件系统 ，是**Linux内核信息的抽象文件接口**, 大量内核中的信息以及可调参数都被作为常规**文件映射**到一个**目录树中**
     - **echo或cat**这样的文件操作命令对系统信息进行查取
   - netlink：用户态应用使用标准的**socket API**就可以使用 netlink 提供的强大功能；
   - ioctl：函数是文件结构中的一个属性分量，就是说如果你的驱动程序提供了对ioctl的支持，用户就可以在用户程序中使用ioctl函数**控制设备的I/O通道**。

